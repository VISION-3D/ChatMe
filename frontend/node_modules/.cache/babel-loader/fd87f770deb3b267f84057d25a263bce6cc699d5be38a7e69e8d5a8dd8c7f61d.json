{"ast":null,"code":"var _jsxFileName = \"D:\\\\bureau\\\\chatme\\\\frontend\\\\src\\\\services\\\\api.js\";\nimport axios from 'axios';\nimport { ChatRoomProvider } from './contexts/ChatRoomContext';\nimport { AuthProvider } from './contexts/AuthContext';\n// Utilisez soit l'URL compl√®te, soit le proxy\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '/api';\n// Instance Axios configur√©e\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 10000 // Timeout de 10 secondes\n});\nfunction App() {\n  return /*#__PURE__*/_jsxDEV(AuthProvider, {\n    children: /*#__PURE__*/_jsxDEV(ChatRoomProvider, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 18,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 17,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 16,\n    columnNumber: 5\n  }, this);\n}\n// Intercepteur pour ajouter automatiquement le token JWT aux requ√™tes\n_c = App;\napi.interceptors.request.use(config => {\n  // R√©cup√®re le token depuis le localStorage\n  const token = localStorage.getItem('token');\n  if (token) {\n    // Ajoute le token au header Authorization\n    config.headers.Authorization = `Bearer ${token}`;\n    console.log('üîê Token ajout√© √† la requ√™te:', config.url);\n  }\n  return config;\n}, error => {\n  console.error('‚ùå Erreur intercepteur requ√™te:', error);\n  return Promise.reject(error);\n});\n\n// Intercepteur pour g√©rer les erreurs globales\napi.interceptors.response.use(response => {\n  console.log('‚úÖ R√©ponse API r√©ussie:', response.config.url);\n  return response;\n}, error => {\n  var _error$response, _error$config, _error$response2;\n  console.error('‚ùå Erreur API:', (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status, (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url);\n\n  // Si erreur 401 (Non autoris√©), d√©connecte l'utilisateur\n  if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 401) {\n    console.log('üîí Token invalide ou expir√©, d√©connexion...');\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n\n    // Rediriger vers la page de login seulement si on est pas d√©j√† sur la page de login\n    if (!window.location.pathname.includes('/login')) {\n      window.location.href = '/';\n    }\n  }\n  return Promise.reject(error);\n});\n\n// Service d'authentification\nexport const authAPI = {\n  /**\r\n   * Inscription d'un nouvel utilisateur\r\n   * @param {Object} userData - Donn√©es utilisateur {username, email, password}\r\n   * @returns {Promise} Promise avec la r√©ponse\r\n   */\n  register: userData => api.post('/auth/register', userData),\n  /**\r\n   * Connexion d'un utilisateur\r\n   * @param {Object} credentials - Identifiants {email, password}\r\n   * @returns {Promise} Promise avec la r√©ponse\r\n   */\n  login: credentials => api.post('/auth/login', credentials),\n  // D√©connexion de l'utilisateur\n\n  logout: () => api.post('/auth/logout'),\n  verify: () => api.get('/auth/verify')\n};\n// Services pour les salons de discussion\nexport const chatRoomAPI = {\n  create: roomData => api.post('/chatrooms', roomData),\n  getAll: params => api.get('/chatrooms', {\n    params\n  }),\n  getMyRooms: () => api.get('/chatrooms/my'),\n  join: roomId => api.post(`/chatrooms/${roomId}/join`),\n  leave: roomId => api.post(`/chatrooms/${roomId}/leave`)\n};\nexport default api;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["axios","ChatRoomProvider","AuthProvider","jsxDEV","_jsxDEV","API_BASE_URL","process","env","REACT_APP_API_URL","api","create","baseURL","headers","timeout","App","children","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","interceptors","request","use","config","token","localStorage","getItem","Authorization","console","log","url","error","Promise","reject","response","_error$response","_error$config","_error$response2","status","removeItem","window","location","pathname","includes","href","authAPI","register","userData","post","login","credentials","logout","verify","get","chatRoomAPI","roomData","getAll","params","getMyRooms","join","roomId","leave","$RefreshReg$"],"sources":["D:/bureau/chatme/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\nimport { ChatRoomProvider } from './contexts/ChatRoomContext';\r\nimport { AuthProvider } from './contexts/AuthContext';\r\n// Utilisez soit l'URL compl√®te, soit le proxy\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '/api';\r\n// Instance Axios configur√©e\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 10000, // Timeout de 10 secondes\r\n});\r\nfunction App() {\r\n  return (\r\n    <AuthProvider>\r\n      <ChatRoomProvider>\r\n        <div className=\"App\">\r\n          {/* Votre contenu existant */}\r\n        </div>\r\n      </ChatRoomProvider>\r\n    </AuthProvider>\r\n  );\r\n}\r\n// Intercepteur pour ajouter automatiquement le token JWT aux requ√™tes\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    // R√©cup√®re le token depuis le localStorage\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      // Ajoute le token au header Authorization\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n      console.log('üîê Token ajout√© √† la requ√™te:', config.url);\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    console.error('‚ùå Erreur intercepteur requ√™te:', error);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Intercepteur pour g√©rer les erreurs globales\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    console.log('‚úÖ R√©ponse API r√©ussie:', response.config.url);\r\n    return response;\r\n  },\r\n  (error) => {\r\n    console.error('‚ùå Erreur API:', error.response?.status, error.config?.url);\r\n    \r\n    // Si erreur 401 (Non autoris√©), d√©connecte l'utilisateur\r\n    if (error.response?.status === 401) {\r\n      console.log('üîí Token invalide ou expir√©, d√©connexion...');\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n      \r\n      // Rediriger vers la page de login seulement si on est pas d√©j√† sur la page de login\r\n      if (!window.location.pathname.includes('/login')) {\r\n        window.location.href = '/';\r\n      }\r\n    }\r\n    \r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Service d'authentification\r\nexport const authAPI = {\r\n  /**\r\n   * Inscription d'un nouvel utilisateur\r\n   * @param {Object} userData - Donn√©es utilisateur {username, email, password}\r\n   * @returns {Promise} Promise avec la r√©ponse\r\n   */\r\n  register: (userData) => api.post('/auth/register', userData),\r\n  \r\n  /**\r\n   * Connexion d'un utilisateur\r\n   * @param {Object} credentials - Identifiants {email, password}\r\n   * @returns {Promise} Promise avec la r√©ponse\r\n   */\r\n  login: (credentials) => api.post('/auth/login', credentials),\r\n  \r\n  // D√©connexion de l'utilisateur\r\n   \r\n  logout: () => api.post('/auth/logout'),\r\n  \r\nverify: () => api.get('/auth/verify'),\r\n};\r\n// Services pour les salons de discussion\r\nexport const chatRoomAPI = {\r\n  create: (roomData) => api.post('/chatrooms', roomData),\r\n  getAll: (params) => api.get('/chatrooms', { params }),\r\n  getMyRooms: () => api.get('/chatrooms/my'),\r\n  join: (roomId) => api.post(`/chatrooms/${roomId}/join`),\r\n  leave: (roomId) => api.post(`/chatrooms/${roomId}/leave`),\r\n};\r\n\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}