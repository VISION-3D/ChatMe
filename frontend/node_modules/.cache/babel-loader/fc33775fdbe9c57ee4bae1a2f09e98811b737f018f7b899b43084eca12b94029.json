{"ast":null,"code":"/**\r\n * Service API pour les appels HTTP vers le backend ChatMe\r\n * Configure Axios avec intercepteurs pour l'authentification\r\n */\nimport axios from 'axios';\n\n// Utilisez soit l'URL complÃ¨te, soit le proxy\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '/api';\n// Instance Axios configurÃ©e\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 10000 // Timeout de 10 secondes\n});\n\n// Intercepteur pour ajouter automatiquement le token JWT aux requÃªtes\napi.interceptors.request.use(config => {\n  // RÃ©cupÃ¨re le token depuis le localStorage\n  const token = localStorage.getItem('token');\n  if (token) {\n    // Ajoute le token au header Authorization\n    config.headers.Authorization = `Bearer ${token}`;\n    console.log('ðŸ” Token ajoutÃ© Ã  la requÃªte:', config.url);\n  }\n  return config;\n}, error => {\n  console.error('âŒ Erreur intercepteur requÃªte:', error);\n  return Promise.reject(error);\n});\n\n// Intercepteur pour gÃ©rer les erreurs globales\napi.interceptors.response.use(response => {\n  console.log('âœ… RÃ©ponse API rÃ©ussie:', response.config.url);\n  return response;\n}, error => {\n  var _error$response, _error$config, _error$response2;\n  console.error('âŒ Erreur API:', (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status, (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url);\n\n  // Si erreur 401 (Non autorisÃ©), dÃ©connecte l'utilisateur\n  if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 401) {\n    console.log('ðŸ”’ Token invalide ou expirÃ©, dÃ©connexion...');\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n\n    // Rediriger vers la page de login seulement si on est pas dÃ©jÃ  sur la page de login\n    if (!window.location.pathname.includes('/login')) {\n      window.location.href = '/';\n    }\n  }\n  return Promise.reject(error);\n});\n\n// Service d'authentification\nexport const authAPI = {\n  /**\r\n   * Inscription d'un nouvel utilisateur\r\n   * @param {Object} userData - DonnÃ©es utilisateur {username, email, password}\r\n   * @returns {Promise} Promise avec la rÃ©ponse\r\n   */\n  register: userData => api.post('/auth/register', userData),\n  /**\r\n   * Connexion d'un utilisateur\r\n   * @param {Object} credentials - Identifiants {email, password}\r\n   * @returns {Promise} Promise avec la rÃ©ponse\r\n   */\n  login: credentials => api.post('/auth/login', credentials),\n  /**\r\n   * DÃ©connexion de l'utilisateur\r\n   * @returns {Promise} Promise avec la rÃ©ponse\r\n   */\n  logout: () => api.post('/auth/logout'),\n  /**\r\n   * VÃ©rification de la validitÃ© du token\r\n   * @returns {Promise} Promise avec la rÃ©ponse\r\n   */\n  verify: () => api.get('/auth/verify')\n};\n\n// Service des salons de discussion (pour les phases suivantes)\nexport const chatRoomAPI = {\n  create: roomData => api.post('/chatrooms', roomData),\n  getAll: () => api.get('/chatrooms'),\n  join: roomId => api.post(`/chatrooms/${roomId}/join`)\n};\nexport default api;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","api","create","baseURL","headers","timeout","interceptors","request","use","config","token","localStorage","getItem","Authorization","console","log","url","error","Promise","reject","response","_error$response","_error$config","_error$response2","status","removeItem","window","location","pathname","includes","href","authAPI","register","userData","post","login","credentials","logout","verify","get","chatRoomAPI","roomData","getAll","join","roomId"],"sources":["D:/bureau/chatme/frontend/src/services/api.js"],"sourcesContent":["/**\r\n * Service API pour les appels HTTP vers le backend ChatMe\r\n * Configure Axios avec intercepteurs pour l'authentification\r\n */\r\nimport axios from 'axios';\r\n\r\n// Utilisez soit l'URL complÃ¨te, soit le proxy\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '/api';\r\n// Instance Axios configurÃ©e\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 10000, // Timeout de 10 secondes\r\n});\r\n\r\n// Intercepteur pour ajouter automatiquement le token JWT aux requÃªtes\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    // RÃ©cupÃ¨re le token depuis le localStorage\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      // Ajoute le token au header Authorization\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n      console.log('ðŸ” Token ajoutÃ© Ã  la requÃªte:', config.url);\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    console.error('âŒ Erreur intercepteur requÃªte:', error);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Intercepteur pour gÃ©rer les erreurs globales\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    console.log('âœ… RÃ©ponse API rÃ©ussie:', response.config.url);\r\n    return response;\r\n  },\r\n  (error) => {\r\n    console.error('âŒ Erreur API:', error.response?.status, error.config?.url);\r\n    \r\n    // Si erreur 401 (Non autorisÃ©), dÃ©connecte l'utilisateur\r\n    if (error.response?.status === 401) {\r\n      console.log('ðŸ”’ Token invalide ou expirÃ©, dÃ©connexion...');\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n      \r\n      // Rediriger vers la page de login seulement si on est pas dÃ©jÃ  sur la page de login\r\n      if (!window.location.pathname.includes('/login')) {\r\n        window.location.href = '/';\r\n      }\r\n    }\r\n    \r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Service d'authentification\r\nexport const authAPI = {\r\n  /**\r\n   * Inscription d'un nouvel utilisateur\r\n   * @param {Object} userData - DonnÃ©es utilisateur {username, email, password}\r\n   * @returns {Promise} Promise avec la rÃ©ponse\r\n   */\r\n  register: (userData) => api.post('/auth/register', userData),\r\n  \r\n  /**\r\n   * Connexion d'un utilisateur\r\n   * @param {Object} credentials - Identifiants {email, password}\r\n   * @returns {Promise} Promise avec la rÃ©ponse\r\n   */\r\n  login: (credentials) => api.post('/auth/login', credentials),\r\n  \r\n  /**\r\n   * DÃ©connexion de l'utilisateur\r\n   * @returns {Promise} Promise avec la rÃ©ponse\r\n   */\r\n  logout: () => api.post('/auth/logout'),\r\n  \r\n  /**\r\n   * VÃ©rification de la validitÃ© du token\r\n   * @returns {Promise} Promise avec la rÃ©ponse\r\n   */\r\n  verify: () => api.get('/auth/verify'),\r\n};\r\n\r\n// Service des salons de discussion (pour les phases suivantes)\r\nexport const chatRoomAPI = {\r\n  create: (roomData) => api.post('/chatrooms', roomData),\r\n  getAll: () => api.get('/chatrooms'),\r\n  join: (roomId) => api.post(`/chatrooms/${roomId}/join`),\r\n};\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}